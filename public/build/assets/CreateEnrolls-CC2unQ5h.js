import{s as H}from"./index-xVtuQsS3.js";import{s as J}from"./index-Bwo2KSLI.js";import{s as K}from"./index-C7dvqZhl.js";import{s as X}from"./index-kJG44KYi.js";import{s as Z}from"./index-BUMsHM9b.js";import{i as ee,r as s,f as C,n as le,q as ae,o as se,c as S,e as r,d as l,w,l as te,u as t,k as oe,s as re,A as m,t as p,v as j,F as ie,b as f}from"./app-Dg6_If3w.js";import{c as ne,a as v,u as de}from"./index.esm-B3CXHi-X.js";import"./moment-C5S46NFB.js";import{d as ue}from"./debounce-BMmXVQ06.js";import{p as ce,f as me,i as pe}from"./parseISO-B4U0aIQH.js";import"./index-An9NzH2t.js";import"./index-BDMYIOAl.js";import"./index-BfGzJPO8.js";import"./index-JaNCC1uL.js";import"./index-DrHOwJMB.js";import"./index-DGF7M1yp.js";import"./index-D9M6F0mg.js";import"./index-8GbJIJWL.js";import"./index-BQxnr25f.js";import"./index-DNq5N3QD.js";import"./index-Wxp8pAOr.js";import"./index-C4DqyGF-.js";import"./index-B5-4kyNr.js";import"./index-Crg88osL.js";const fe={key:0,class:"flex flex-col md:flex-row gap-12 min-h-screen items-center justify-center"},ve={class:"w-full"},_e={class:"flex flex-col gap-4 text-center"},xe={key:1,class:"flex flex-col md:flex-row gap-12"},be={class:"w-full"},ge={class:"card flex flex-col gap-4"},ye={class:"w-full"},he={class:"flex flex-col gap-2"},Ve={id:"user_id-help",class:"p-error"},ke={class:"flex flex-col gap-2"},De={id:"course_id-help",class:"p-error"},Ce={class:"flex flex-col gap-2"},Se={id:"enrolled_at-help",class:"p-error"},we={class:"flex flex-col gap-2"},Me={id:"expires_at-help",class:"p-error"},ll={__name:"CreateEnrolls",setup(Be){const _=le(),n=ee();s(null);const x=s(!0),b=s(!1);let M=s(null);const B=s(""),E=s(null),z=s(1);s(15),s(0);const g=s(!1),$=s(null),q=s(null),d=s(!1);s([{label:"Masculino",value:"male"},{label:"Feminino",value:"female"},{label:"Outro",value:"other"}]);function F(a){const e=typeof a=="string"?ce(a):a;return pe(e)?me(e,"yyyy-MM-dd"):""}const O=ne({user_id:v().required().trim().label("user"),course_id:v().required().trim().label("Email"),enrolled_at:v().required().label("Data Inicio"),expires_at:v().required().label("Data de Expiração")}),{defineField:u,handleSubmit:A,resetForm:Ee,errors:i,setErrors:R}=de({validationSchema:O}),[y]=u("user_id"),[h]=u("course_id"),[V]=u("enrolled_at"),[k]=u("expires_at"),I=s();function P(){_&&_.back()}const U=()=>{g.value=!1},D=A(a=>{I.value!=null&&(a.image=I.value),a.enrolled_at=F(a.enrolled_at),a.expires_at=F(a.expires_at),d.value=!0,C.post("/api/enrollments",a,{headers:{"Content-Type":"multipart/form-data"}}).then(e=>{_.back(),n.add({severity:"success",summary:"Successo",detail:"Matricula criado com sucesso",life:3e3})}).catch(e=>{d.value=!1,n.add({severity:"error",summary:"Erro}",detail:`${e.response.data.message}`,life:3e3}),e.response.data.errors&&R(e.response.data.errors)}).finally(()=>{d.value=!1})}),N=async(a=1)=>{C.get("/api/enrollments/create",{params:{query:B.value}}).then(e=>{q.value=e.data.courses,$.value=e.data.users,x.value=!1}).catch(e=>{x.value=!1,n.add({severity:"error",summary:`${e}`,detail:"Message Detail",life:3e3}),P()})},W=()=>{b.value=!0,C.delete(`/api/enrollments/${M.value}`).then(()=>{E.value.data=E.value.data.filter(a=>a.id!==M.value),U(),n.add({severity:"success",summary:"Sucesso",detail:"Sucesso ao apagar",life:3e3})}).catch(a=>{n.add({severity:"error",summary:"Erro",detail:`${a}`,life:3e3}),b.value=!1}).finally(()=>{b.value=!1})},Q=ue(()=>{N(z.value)},300);return ae(B,Q),se(()=>{N()}),(a,e)=>{const T=Z,c=X,L=K,Y=J,G=H;return f(),S(ie,null,[x.value?(f(),S("div",fe,[l("div",ve,[l("div",_e,[r(T,{style:{width:"50px",height:"50px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:".5s","aria-label":"Custom ProgressSpinner"}),e[6]||(e[6]=l("p",null,"Por Favor Aguarde...",-1))])])])):(f(),S("div",xe,[l("div",be,[l("div",ge,[l("div",ye,[r(c,{label:"Voltar",class:"mr-2 mb-2",onClick:P},{default:w(()=>e[7]||(e[7]=[l("i",{class:"pi pi-angle-left"},null,-1),te(" Voltar")])),_:1})]),e[12]||(e[12]=l("div",{class:"font-semibold text-xl"},"Matricula",-1)),e[13]||(e[13]=l("small",{class:"p-error"},"Os campos marcados * sao considerados campos obrigatorios.",-1)),l("form",{onSubmit:e[4]||(e[4]=(...o)=>t(D)&&t(D)(...o))},[l("div",he,[e[8]||(e[8]=l("label",{for:"user_id"},"Estudante",-1)),r(L,{modelValue:t(y),"onUpdate:modelValue":e[0]||(e[0]=o=>m(y)?y.value=o:null),filter:"",options:$.value,optionValue:"id",optionLabel:"name",placeholder:"Selecionar Estudante",class:"w-full md:w-14rem"},null,8,["modelValue","options"]),l("small",Ve,p(t(i).user_id),1)]),l("div",ke,[e[9]||(e[9]=l("label",{for:"course_id"},"Curso",-1)),r(L,{modelValue:t(h),"onUpdate:modelValue":e[1]||(e[1]=o=>m(h)?h.value=o:null),filter:"",options:q.value,optionValue:"id",optionLabel:"title",placeholder:"Selecionar Curso",class:"w-full md:w-14rem"},null,8,["modelValue","options"]),l("small",De,p(t(i).course_id),1)]),l("div",Ce,[e[10]||(e[10]=l("label",{for:"enrolled_at"},"Inicio da Matricula",-1)),r(Y,{modelValue:t(V),"onUpdate:modelValue":e[2]||(e[2]=o=>m(V)?V.value=o:null),id:"enrolled_at",placeholder:"Data Inicio",class:j({"p-invalid":t(i).enrolled_at}),type:"text"},null,8,["modelValue","class"]),l("small",Se,p(t(i).enrolled_at),1)]),l("div",we,[e[11]||(e[11]=l("label",{for:"expires_at"},"Inicio da Matricula",-1)),r(Y,{modelValue:t(k),"onUpdate:modelValue":e[3]||(e[3]=o=>m(k)?k.value=o:null),id:"expires_at",placeholder:"Data Expira",class:j({"p-invalid":t(i).expires_at}),type:"text"},null,8,["modelValue","class"]),l("small",Me,p(t(i).expires_at),1)]),r(c,{label:"Submeter",class:"mr-2 mb-2",onClick:t(D),disabled:d.value},null,8,["onClick","disabled"]),d.value?(f(),oe(T,{key:0,style:{width:"35px",height:"35px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:".5s","aria-label":"Custom ProgressSpinner"})):re("",!0)],32)])])])),r(G,{header:"Confirmação",visible:g.value,"onUpdate:visible":e[5]||(e[5]=o=>g.value=o),style:{width:"350px"},modal:!0},{footer:w(()=>[r(c,{label:"Não",icon:"pi pi-times",onClick:U,class:"p-button-text"}),r(c,{label:"Sim",icon:"pi pi-check",onClick:W,class:"p-button-text",autofocus:""})]),default:w(()=>[e[14]||(e[14]=l("div",{class:"flex align-items-center justify-content-center"},[l("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}}),l("span",null,"Tem certeza que deseja proceder?")],-1))]),_:1},8,["visible"])],64)}}};export{ll as default};
