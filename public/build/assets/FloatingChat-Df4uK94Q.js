import{h as k,r as l,c as d,d as n,s as j,F as B,m as S,j as T,aV as F,aw as V,x as g,v as w,t as $,b as p,_ as D}from"./app-Dg6_If3w.js";const E={class:"fixed bottom-4 right-4 z-50"},q={key:0,class:"w-[400px] h-[600px] bg-white rounded-xl shadow-xl flex flex-col overflow-hidden mt-4"},z={class:"p-2 border-t"},I=k({__name:"FloatingChat",setup(N){const u=l(!1),c=l(""),s=l([]),v=l(null),r=l({}),i=l(null),h=()=>{u.value=!u.value,u.value&&s.value.length===0&&y(),g(()=>{var o;(o=i.value)==null||o.scrollTo({top:i.value.scrollHeight})})},y=async()=>{const t=await(await fetch("/api/frontend-chatbot")).json();v.value=t.id,s.value.push({from:"bot",text:t.message}),r.value={},t.answers.forEach((e,a)=>{const x=`${a+1}Ô∏è‚É£ ${e.label}`;s.value.push({from:"bot",text:x}),r.value[(a+1).toString()]=e.id})},_=async()=>{const o=c.value.trim();if(!o)return;s.value.push({from:"user",text:o}),c.value="";const t=r.value[o];if(!t){s.value.push({from:"bot",text:"Por favor, selecione uma op√ß√£o v√°lida (ex: 1, 2, 3...)"});return}try{const a=await(await fetch("/api/frontend-chatbot/answer",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({input:t})})).json();if(a.type==="question"){const f=await(await fetch(`/api/frontend-chatbot/question/${a.id}`)).json();v.value=f.id,s.value.push({from:"bot",text:f.body}),r.value={},f.answers.forEach((m,b)=>{const C=`${b+1}Ô∏è‚É£ ${m.title}`;s.value.push({from:"bot",text:C}),r.value[(b+1).toString()]=m.id})}else s.value.push({from:"bot",text:a.response})}catch{s.value.push({from:"bot",text:"Erro ao comunicar com o servidor."})}g(()=>{var e;(e=i.value)==null||e.scrollTo({top:i.value.scrollHeight})})};return(o,t)=>(p(),d("div",E,[n("button",{onClick:h,class:"w-14 h-14 rounded-full bg-blue-700 text-white shadow-lg flex items-center justify-center text-xl"}," üí¨ "),u.value?(p(),d("div",q,[n("div",{class:"bg-blue-700 text-white px-4 py-2 text-sm font-bold flex justify-between items-center"},[t[1]||(t[1]=n("span",null,"Assistente Virtual Barzilay Linguistic Services",-1)),n("button",{onClick:h,class:"text-white"},"‚úñ")]),n("div",{class:"flex-1 p-3 overflow-y-auto text-sm space-y-2",ref_key:"messageBox",ref:i},[(p(!0),d(B,null,S(s.value,(e,a)=>(p(),d("div",{key:a,class:w(e.from==="user"?"text-right":"text-left")},[n("div",{class:w([e.from==="user"?"bg-green-100":"bg-gray-100","inline-block px-3 py-2 rounded"])},$(e.text),3)],2))),128))],512),n("div",z,[T(n("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>c.value=e),onKeyup:V(_,["enter"]),class:"w-full px-3 py-2 border rounded text-sm",placeholder:"Digite sua mensagem ou n√∫mero da op√ß√£o..."},null,544),[[F,c.value]])])])):j("",!0)]))}}),H=D(I,[["__scopeId","data-v-a02f47b8"]]);export{H as F};
