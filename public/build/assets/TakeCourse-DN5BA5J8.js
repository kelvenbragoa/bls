import{T as _e}from"./index-B22k0zKU.js";import{s as he}from"./index-yC7VgUO7.js";import{s as ye}from"./index-BDV0PAbU.js";import{s as we}from"./index-BuOmVI7m.js";import{s as Ce}from"./index-kJG44KYi.js";import{s as Te}from"./index-BUMsHM9b.js";import{h as De,r,i as Ee,p as Se,o as Me,q as $e,c as f,d as e,e as d,w as k,u as S,R as Pe,t as u,k as M,s as b,v as m,F as ze,m as Re,l as te,j as je,f as se,n as Ve,b as l,x as Ie,_ as Le}from"./app-Dg6_If3w.js";import{h as ae}from"./moment-C5S46NFB.js";import"./index-BfGzJPO8.js";import"./index-BQxnr25f.js";import"./index-DNq5N3QD.js";import"./index-B5-4kyNr.js";const Ae={key:0,class:"flex flex-col md:flex-row gap-12 min-h-screen items-center justify-center bg-surface-0 dark:bg-surface-900"},Be={class:"w-full"},Ne={class:"flex flex-col gap-4 text-center"},Ye={key:1,class:"min-h-screen bg-surface-50 dark:bg-surface-900"},Oe={class:"bg-surface-0 dark:bg-surface-800 border-b border-surface-200 dark:border-surface-700 px-4 py-3"},Fe={class:"flex items-center justify-between max-w-screen-2xl mx-auto"},We={class:"flex items-center gap-4"},qe={class:"hidden md:block text-surface-600 dark:text-surface-400"},Ue={class:"text-sm font-medium"},He={class:"flex items-center gap-2"},Je={class:"flex h-[calc(100vh-64px)]"},Ke={key:0,class:"p-4"},Qe={class:"mb-6"},Ge={class:"text-lg font-bold text-surface-900 dark:text-surface-0 mb-2"},Xe={class:"flex items-center gap-4 text-sm text-surface-600 dark:text-surface-400"},Ze={class:"space-y-2"},et=["onClick"],tt={class:"flex items-start gap-3"},st={class:"flex-1 min-w-0"},at={class:"flex items-center gap-2 text-xs text-surface-500 dark:text-surface-400"},rt={key:0},ot={class:"flex-1 flex flex-col"},lt={key:0,class:"w-full h-full relative"},it={key:0,class:"absolute inset-0 bg-black/50 flex items-center justify-center z-10"},nt={class:"text-center text-white"},dt=["poster","src"],ut=["src"],ct=["href"],pt={key:1,class:"w-full h-full flex items-center justify-center bg-surface-800"},ft={class:"absolute top-4 right-4 flex gap-2"},vt={class:"max-w-4xl mx-auto p-6"},gt={class:"mb-6"},mt={class:"flex items-center justify-between mb-4"},xt={class:"text-2xl font-bold text-surface-900 dark:text-surface-0"},bt={class:"flex items-center gap-2"},kt={class:"mb-4"},_t={class:"flex items-center justify-between mb-2 text-sm text-surface-600 dark:text-surface-400"},ht={key:0,class:"mb-4 p-3 bg-surface-100 dark:bg-surface-700 rounded-lg"},yt={class:"flex items-center justify-between text-sm"},wt={class:"flex items-center gap-4"},Ct={class:"flex items-center gap-1"},Tt={class:"text-surface-700 dark:text-surface-300"},Dt={class:"flex items-center gap-2"},Et={key:0,class:"flex items-center gap-1 text-orange-600"},St={key:1,class:"flex items-center gap-1 text-green-600"},Mt={class:"mb-8"},$t={class:"flex items-center gap-2 mb-4"},Pt={key:0,class:"prose dark:prose-invert max-w-none bg-surface-0 dark:bg-surface-700 p-4 rounded-lg border border-surface-200 dark:border-surface-600"},zt={class:"text-surface-800 dark:text-surface-100 leading-relaxed whitespace-pre-line font-medium"},Rt={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},jt={class:"space-y-3"},Vt={class:"space-y-4"},It={class:"flex justify-between items-center p-4 bg-gradient-to-r from-blue-50 to-blue-100 dark:from-blue-900/30 dark:to-blue-800/30 rounded-lg border border-blue-200 dark:border-blue-700"},Lt={class:"font-bold text-xl text-blue-900 dark:text-blue-100 bg-white dark:bg-blue-800 px-3 py-1 rounded-full"},At={class:"flex justify-between items-center p-4 bg-gradient-to-r from-green-50 to-green-100 dark:from-green-900/30 dark:to-green-800/30 rounded-lg border border-green-200 dark:border-green-700"},Bt={class:"font-bold text-xl text-green-900 dark:text-green-100 bg-white dark:bg-green-800 px-3 py-1 rounded-full"},Nt={class:"flex justify-between items-center p-4 bg-gradient-to-r from-purple-50 to-purple-100 dark:from-purple-900/30 dark:to-purple-800/30 rounded-lg border border-purple-200 dark:border-purple-700"},Yt={class:"font-bold text-xl text-purple-900 dark:text-purple-100 bg-white dark:bg-purple-800 px-3 py-1 rounded-full"},Ot={class:"flex justify-between items-center p-4 bg-gradient-to-r from-orange-50 to-orange-100 dark:from-orange-900/30 dark:to-orange-800/30 rounded-lg border border-orange-200 dark:border-orange-700"},Ft={class:"font-bold text-xl text-orange-900 dark:text-orange-100 bg-white dark:bg-orange-800 px-3 py-1 rounded-full"},Wt=De({__name:"TakeCourse",setup(qt){const y=Ve(),w=r(null),C=Ee();r(null);const T=r(!0);r(!1),r(null);const re=r(""),i=r(null);r(1),r(15),r(0),r(!1);const c=r(0),_=r(!1),$=r(!1);r(0);const D=r(0),oe=r(0),h=r(!1),P=r(""),x=r(!1),g=r(!1),z=r(null),p=Se(()=>{var s,t;return((t=(s=i.value)==null?void 0:s.topics)==null?void 0:t[c.value])||null}),le=()=>{se.post("/api/logout").then(s=>{localStorage.removeItem("token"),localStorage.removeItem("user"),y.replace("/auth/login")}).catch(s=>{console.error("Erro ao fazer logout:",s),localStorage.removeItem("token"),localStorage.removeItem("user"),y.replace("/auth/login")})},ie=async(s=1)=>{se.get(`/api/public/courses/${y.currentRoute.value.params.id}`,{params:{query:re.value}}).then(t=>{i.value=t.data,T.value=!1}).catch(t=>{T.value=!1,C.add({severity:"error",summary:`${t}`,detail:"Message Detail",life:3e3})})},ne=s=>{c.value=s},de=()=>{c.value<i.value.topics.length-1&&c.value++},ue=()=>{c.value>0&&c.value--},ce=()=>{_.value=!_.value},pe=s=>{if(!s)return"0:00";const t=Math.floor(s/60),n=Math.floor(s%60);return`${t}:${n.toString().padStart(2,"0")}`},fe=s=>{C.add({severity:"success",summary:"Aula concluída!",detail:"Parabéns por completar esta aula.",life:3e3})},ve=s=>{console.error("Erro no vídeo:",s);const n=s.target.error;let o="Erro desconhecido no vídeo";if(n)switch(n.code){case n.MEDIA_ERR_ABORTED:o="Carregamento do vídeo foi abortado";break;case n.MEDIA_ERR_NETWORK:o="Erro de rede ao carregar vídeo";break;case n.MEDIA_ERR_DECODE:o="Erro ao decodificar o vídeo";break;case n.MEDIA_ERR_SRC_NOT_SUPPORTED:o="Formato de vídeo não suportado";break}C.add({severity:"error",summary:"Erro no Vídeo",detail:o,life:5e3})},ge=()=>{x.value=!x.value},me=()=>{const s=z.value;if(!s||!s.preload){console.log("Video player not ready yet");return}if("connection"in navigator){const n=navigator.connection.effectiveType;n==="slow-2g"||n==="2g"?s.preload="none":s.preload="metadata"}};return Me(()=>{w.value=JSON.parse(localStorage.getItem("user")),ie()}),$e(p,()=>{var s;(s=p.value)!=null&&s.video_url&&Ie(()=>{setTimeout(()=>{me()},100)})}),(s,t)=>{var j,V,I,L,A,B,N,Y,O,F,W,q,U,H,J,K,Q,G,X;const n=Te,o=Ce,xe=we,be=ye,R=he,ke=_e;return T.value?(l(),f("div",Ae,[e("div",Be,[e("div",Ne,[d(n,{style:{width:"50px",height:"50px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:".5s","aria-label":"Custom ProgressSpinner"}),t[12]||(t[12]=e("p",{class:"text-surface-700 dark:text-surface-300"},"Por Favor Aguarde...",-1))])])])):(l(),f("div",Ye,[e("div",Oe,[e("div",Fe,[e("div",We,[d(o,{icon:"pi pi-bars",text:"",rounded:"",onClick:ce,class:"text-surface-600 dark:text-surface-300"}),d(S(Pe),{to:"/",class:"flex items-center gap-2 hover:opacity-80"},{default:k(()=>t[13]||(t[13]=[e("img",{src:"/logo.png",class:"w-8 h-8",alt:"Logo"},null,-1),e("span",{class:"font-semibold text-surface-900 dark:text-surface-0"},"BLS",-1)])),_:1}),e("div",qe,[t[14]||(t[14]=e("i",{class:"pi pi-angle-right mx-2"},null,-1)),e("span",Ue,u((j=i.value)==null?void 0:j.title),1)])]),e("div",He,[w.value?(l(),M(o,{key:0,label:"Meus Cursos",text:"",size:"small",as:"router-link",to:"/my-courses"})):b("",!0),w.value?(l(),M(o,{key:1,label:"Sair",text:"",size:"small",onClick:le})):(l(),M(o,{key:2,label:"Login",text:"",size:"small",as:"router-link",to:"/auth/login"}))])])]),e("div",Je,[e("div",{class:m(["transition-all duration-300 bg-surface-0 dark:bg-surface-800 border-r border-surface-200 dark:border-surface-700 overflow-y-auto",_.value?"w-0 min-w-0":"w-80 min-w-80"])},[_.value?b("",!0):(l(),f("div",Ke,[e("div",Qe,[e("h2",Ge,u((V=i.value)==null?void 0:V.title),1),e("div",Xe,[e("span",null,u(((L=(I=i.value)==null?void 0:I.topics)==null?void 0:L.length)||0)+" aulas",1),e("span",null,u(((A=i.value)==null?void 0:A.duration)||"Duração variável"),1)])]),e("div",Ze,[(l(!0),f(ze,null,Re((B=i.value)==null?void 0:B.topics,(a,v)=>(l(),f("div",{key:a.id,class:m(["p-3 rounded-lg cursor-pointer transition-all duration-200 border",c.value===v?"bg-primary-50 dark:bg-primary-900/20 border-primary-200 dark:border-primary-700":"bg-surface-50 dark:bg-surface-700 border-surface-200 dark:border-surface-600 hover:bg-surface-100 dark:hover:bg-surface-600"]),onClick:E=>ne(v)},[e("div",tt,[e("div",{class:m(["flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center mt-1",c.value===v?"bg-primary-500 text-white":"bg-surface-200 dark:bg-surface-600 text-surface-600 dark:text-surface-300"])},[e("i",{class:m([c.value===v?"pi pi-pause":"pi pi-play","text-xs"])},null,2)],2),e("div",st,[e("h4",{class:m(["font-medium text-sm mb-1 line-clamp-2",c.value===v?"text-primary-700 dark:text-primary-300":"text-surface-900 dark:text-surface-100"])},u(v+1)+". "+u(a.title),3),e("div",at,[t[15]||(t[15]=e("i",{class:"pi pi-clock"},null,-1)),e("span",null,u(a.duration||"5:00"),1),a.video_url?(l(),f("span",rt,"• Vídeo")):b("",!0)])]),t[16]||(t[16]=e("div",{class:"flex-shrink-0"},[e("i",{class:"pi pi-check-circle text-green-500 text-sm"})],-1))])],10,et))),128))])]))],2),e("div",ot,[e("div",{class:m(["relative bg-surface-900 dark:bg-surface-950 video-player-container transition-all duration-300",x.value?"h-96":"h-80"])},[(N=p.value)!=null&&N.video_url?(l(),f("div",lt,[g.value?(l(),f("div",it,[e("div",nt,[d(n,{style:{width:"40px",height:"40px"},strokeWidth:"4",fill:"transparent",animationDuration:"1s"}),t[17]||(t[17]=e("p",{class:"mt-2 text-sm"},"Carregando vídeo...",-1))])])):b("",!0),e("video",{ref_key:"videoPlayer",ref:z,class:"w-full h-full object-contain bg-black",controls:"",preload:"metadata",playsinline:"",crossorigin:"anonymous",poster:(Y=p.value)!=null&&Y.thumbnail?"/storage/"+p.value.thumbnail:null,src:"/storage/"+p.value.video_url,onLoadstart:t[0]||(t[0]=a=>g.value=!0),onLoadeddata:t[1]||(t[1]=a=>g.value=!1),onCanplay:t[2]||(t[2]=a=>g.value=!1),onLoadedmetadata:t[3]||(t[3]=a=>D.value=a.target.duration),onTimeupdate:t[4]||(t[4]=a=>oe.value=a.target.currentTime),onPlay:t[5]||(t[5]=a=>$.value=!0),onPause:t[6]||(t[6]=a=>$.value=!1),onError:ve,onWaiting:t[7]||(t[7]=a=>g.value=!0),onPlaying:t[8]||(t[8]=a=>g.value=!1)},[e("source",{src:"/storage/"+p.value.video_url,type:"video/mp4"},null,8,ut),e("p",null,[t[18]||(t[18]=te("Seu navegador não suporta vídeo HTML5. ")),e("a",{href:"/storage/"+p.value.video_url},"Baixe o vídeo",8,ct),t[19]||(t[19]=te("."))])],40,dt)])):(l(),f("div",pt,t[20]||(t[20]=[e("div",{class:"text-center text-surface-300"},[e("i",{class:"pi pi-video text-6xl mb-4"}),e("p",null,"Nenhum vídeo disponível para esta aula")],-1)]))),e("div",ft,[je(d(o,{icon:x.value?"pi pi-window-minimize":"pi pi-window-maximize",rounded:"",text:"",class:"bg-black/50 text-white hover:bg-black/70",onClick:ge},null,8,["icon"]),[[ke,x.value?"Diminuir vídeo":"Expandir vídeo",void 0,{left:!0}]]),d(o,{icon:"pi pi-cog",rounded:"",text:"",class:"bg-black/50 text-white hover:bg-black/70"})])],2),e("div",{class:m(["flex-1 overflow-y-auto bg-surface-50 dark:bg-surface-800 border-t border-surface-200 dark:border-surface-700 content-area",x.value?"h-[calc(100vh-448px)]":"h-[calc(100vh-384px)]"])},[e("div",vt,[e("div",gt,[e("div",mt,[e("h1",xt,u((O=p.value)==null?void 0:O.title),1),e("div",bt,[d(o,{icon:"pi pi-step-backward",rounded:"",outlined:"",size:"small",onClick:ue,disabled:c.value===0},null,8,["disabled"]),d(o,{icon:"pi pi-step-forward",rounded:"",outlined:"",size:"small",onClick:de,disabled:c.value>=((W=(F=i.value)==null?void 0:F.topics)==null?void 0:W.length)-1},null,8,["disabled"]),d(o,{label:"Marcar como Concluída",icon:"pi pi-check",size:"small",onClick:t[9]||(t[9]=a=>{var v;return fe((v=p.value)==null?void 0:v.id)})})])]),e("div",kt,[e("div",_t,[t[21]||(t[21]=e("span",null,"Progresso da aula",-1)),e("span",null,u(Math.round((c.value+1)/((U=(q=i.value)==null?void 0:q.topics)==null?void 0:U.length)*100))+"%",1)]),d(xe,{value:Math.round((c.value+1)/((J=(H=i.value)==null?void 0:H.topics)==null?void 0:J.length)*100),class:"h-2"},null,8,["value"])]),(K=p.value)!=null&&K.video_url?(l(),f("div",ht,[e("div",yt,[e("div",wt,[e("span",Ct,[t[22]||(t[22]=e("i",{class:"pi pi-clock text-primary-500"},null,-1)),e("span",Tt,u(D.value?pe(D.value):"Carregando..."),1)]),t[23]||(t[23]=e("span",{class:"flex items-center gap-1"},[e("i",{class:"pi pi-video text-primary-500"}),e("span",{class:"text-surface-700 dark:text-surface-300"},"MP4")],-1))]),e("div",Dt,[g.value?(l(),f("span",Et,t[24]||(t[24]=[e("i",{class:"pi pi-spin pi-spinner"},null,-1),e("span",{class:"text-xs"},"Buffering...",-1)]))):(l(),f("span",St,t[25]||(t[25]=[e("i",{class:"pi pi-check-circle"},null,-1),e("span",{class:"text-xs"},"Pronto",-1)])))])])])):b("",!0)]),e("div",Mt,[e("div",$t,[t[26]||(t[26]=e("h3",{class:"text-lg font-semibold text-surface-900 dark:text-surface-0"}," Sobre esta aula ",-1)),d(o,{icon:h.value?"pi pi-chevron-up":"pi pi-chevron-down",text:"",rounded:"",size:"small",onClick:t[10]||(t[10]=a=>h.value=!h.value)},null,8,["icon"])]),h.value||!((Q=p.value)!=null&&Q.description)?(l(),f("div",Pt,[e("p",zt,u(((G=p.value)==null?void 0:G.description)||((X=p.value)==null?void 0:X.content)||"Nenhuma descrição disponível para esta aula."),1)])):b("",!0)]),e("div",Rt,[d(R,{class:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-800 dark:to-slate-900 border-2 border-slate-200 dark:border-slate-700"},{title:k(()=>t[27]||(t[27]=[e("div",{class:"flex items-center gap-2 text-slate-800 dark:text-slate-100"},[e("i",{class:"pi pi-file-edit text-indigo-600 dark:text-indigo-400 text-lg"}),e("span",{class:"font-bold"},"Minhas Anotações")],-1)])),content:k(()=>[e("div",jt,[d(be,{modelValue:P.value,"onUpdate:modelValue":t[11]||(t[11]=a=>P.value=a),placeholder:"Faça suas anotações sobre esta aula...",rows:"4",class:"w-full border-2 border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"},null,8,["modelValue"]),d(o,{label:"Salvar Anotações",icon:"pi pi-save",size:"small",class:"bg-indigo-600 hover:bg-indigo-700 border-indigo-600 text-white font-medium"})])]),_:1}),d(R,{class:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-800 dark:to-slate-900 border-2 border-slate-200 dark:border-slate-700"},{title:k(()=>t[28]||(t[28]=[e("div",{class:"flex items-center gap-2 text-slate-800 dark:text-slate-100"},[e("i",{class:"pi pi-info-circle text-cyan-600 dark:text-cyan-400 text-lg"}),e("span",{class:"font-bold"},"Informações do Curso")],-1)])),content:k(()=>{var a,v,E,Z,ee;return[e("div",Vt,[e("div",It,[t[29]||(t[29]=e("div",{class:"flex items-center gap-2"},[e("i",{class:"pi pi-book text-blue-600 dark:text-blue-400"}),e("span",{class:"text-blue-900 dark:text-blue-100 font-semibold"},"Total de aulas:")],-1)),e("span",Lt,u(((v=(a=i.value)==null?void 0:a.topics)==null?void 0:v.length)||0),1)]),e("div",At,[t[30]||(t[30]=e("div",{class:"flex items-center gap-2"},[e("i",{class:"pi pi-clock text-green-600 dark:text-green-400"}),e("span",{class:"text-green-900 dark:text-green-100 font-semibold"},"Duração total:")],-1)),e("span",Bt,u(((E=i.value)==null?void 0:E.duration)||"Variável"),1)]),e("div",Nt,[t[31]||(t[31]=e("div",{class:"flex items-center gap-2"},[e("i",{class:"pi pi-calendar text-purple-600 dark:text-purple-400"}),e("span",{class:"text-purple-900 dark:text-purple-100 font-semibold"},"Criado em:")],-1)),e("span",Yt,u(S(ae)((Z=i.value)==null?void 0:Z.created_at).format("DD/MM/YYYY")),1)]),e("div",Ot,[t[32]||(t[32]=e("div",{class:"flex items-center gap-2"},[e("i",{class:"pi pi-refresh text-orange-600 dark:text-orange-400"}),e("span",{class:"text-orange-900 dark:text-orange-100 font-semibold"},"Última atualização:")],-1)),e("span",Ft,u(S(ae)((ee=i.value)==null?void 0:ee.updated_at).format("DD/MM/YYYY")),1)])])]}),_:1})])])],2)])])]))}}}),rs=Le(Wt,[["__scopeId","data-v-39687ae9"]]);export{rs as default};
