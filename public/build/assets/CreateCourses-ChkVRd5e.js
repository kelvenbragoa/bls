import{s as te}from"./index-xVtuQsS3.js";import{s as oe}from"./index-BAXlNvHD.js";import{s as le}from"./index-8GbJIJWL.js";import{s as ae}from"./index-kJG44KYi.js";import{s as ie}from"./index-BUMsHM9b.js";import{i as re,r as o,f as B,n as ne,q as de,o as ue,c as p,e as a,d as s,w as $,l as W,u as l,k as ce,s as T,v as M,A as P,t as f,F as me,b as d}from"./app-Dg6_If3w.js";import{c as pe,a as q,u as fe}from"./index.esm-B3CXHi-X.js";import"./moment-C5S46NFB.js";import{d as ve}from"./debounce-BMmXVQ06.js";import{p as ge,f as be,i as xe}from"./parseISO-B4U0aIQH.js";import"./index-An9NzH2t.js";import"./index-BDMYIOAl.js";import"./index-DyaxPoKb.js";import"./index-SVcKsKQj.js";import"./index-BuOmVI7m.js";import"./index-B5-4kyNr.js";import"./index-BQxnr25f.js";import"./index-DNq5N3QD.js";const ye={key:0,class:"flex flex-col md:flex-row gap-12 min-h-screen items-center justify-center"},he={class:"w-full"},_e={class:"flex flex-col gap-4 text-center"},ke={key:1,class:"flex flex-col md:flex-row gap-12"},De={class:"w-full"},Ce={class:"card flex flex-col gap-4"},Se={class:"w-full"},Ve={class:"flex flex-col gap-2"},we={id:"title-help",class:"p-error"},Ue={class:"flex flex-col gap-2"},Fe={id:"description-help",class:"p-error"},Be={class:"flex flex-col gap-2"},$e={id:"duration-help",class:"p-error"},Te={class:"flex flex-col gap-"},Me={key:0,class:"mt-2"},Pe=["src"],qe={class:"text-sm mt-1 text-gray-600"},Ne={class:"flex flex-col gap-2"},Re={key:0,class:"mt-2"},je={controls:"",class:"w-64 h-40 rounded border"},ze=["src"],Ee={class:"text-sm mt-1 text-gray-600"},rs={__name:"CreateCourses",setup(Le){const b=ne(),u=re();o(null);const x=o(!0),y=o(!1);let N=o(null);const R=o(""),h=o(null),Y=o(1);o(15),o(0);const _=o(!1),A=o(null),c=o(!1);o([{label:"Masculino",value:"male"},{label:"Feminino",value:"female"},{label:"Outro",value:"other"}]);const v=o(),g=o(),k=o(null),D=o(null);function Q(t){const e=typeof t=="string"?ge(t):t;return xe(e)?be(e,"yyyy-MM-dd"):""}const G=pe({title:q().required().trim().label("Name"),description:q().required().trim().label("Email"),duration:q().required().trim().label("Duration")}),{defineField:C,handleSubmit:H,resetForm:Ie,errors:r,setErrors:J}=fe({validationSchema:G}),[S]=C("title"),[V]=C("description"),[w]=C("duration");function j(){b&&b.back()}const z=()=>{_.value=!1},K=t=>{const e=t.files[0];if(v.value=t.files[0],console.log(v.value),e&&e.type.startsWith("image/")){const m=new FileReader;m.onload=n=>{k.value=n.target.result},m.readAsDataURL(e)}},X=t=>{const e=t.files[0];g.value=t.files[0],console.log(g.value),e&&e.type.startsWith("video/")&&(D.value=URL.createObjectURL(e))},U=H(t=>{v.value!=null&&(t.image=v.value),g.value!=null&&(t.video=g.value),t.birthdate=Q(t.birthdate),c.value=!0,B.post("/api/courses",t,{headers:{"Content-Type":"multipart/form-data"}}).then(e=>{b.back(),u.add({severity:"success",summary:"Successo",detail:"Curso criado com sucesso",life:3e3})}).catch(e=>{c.value=!1,u.add({severity:"error",summary:"Erro}",detail:`${e.response.data.message}`,life:3e3}),e.response.data.errors&&J(e.response.data.errors)}).finally(()=>{c.value=!1})}),E=async(t=1)=>{B.get("/api/courses/create",{params:{query:R.value}}).then(e=>{h.value=e.data.roles,A.value=e.data.roles,x.value=!1}).catch(e=>{x.value=!1,u.add({severity:"error",summary:`${e}`,detail:"Message Detail",life:3e3}),j()})},Z=()=>{y.value=!0,B.delete(`/api/courses/${N.value}`).then(()=>{h.value.data=h.value.data.filter(t=>t.id!==N.value),z(),u.add({severity:"success",summary:"Sucesso",detail:"Sucesso ao apagar",life:3e3})}).catch(t=>{u.add({severity:"error",summary:"Erro",detail:`${t}`,life:3e3}),y.value=!1}).finally(()=>{y.value=!1})},ee=ve(()=>{E(Y.value)},300);return de(R,ee),ue(()=>{E()}),(t,e)=>{var I,O;const m=ie,n=ae,F=le,L=oe,se=te;return d(),p(me,null,[x.value?(d(),p("div",ye,[s("div",he,[s("div",_e,[a(m,{style:{width:"50px",height:"50px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:".5s","aria-label":"Custom ProgressSpinner"}),e[5]||(e[5]=s("p",null,"Por Favor Aguarde...",-1))])])])):(d(),p("div",ke,[s("div",De,[s("div",Ce,[s("div",Se,[a(n,{label:"Voltar",class:"mr-2 mb-2",onClick:j},{default:$(()=>e[6]||(e[6]=[s("i",{class:"pi pi-angle-left"},null,-1),W(" Voltar")])),_:1})]),e[13]||(e[13]=s("div",{class:"font-semibold text-xl"},"Curso",-1)),e[14]||(e[14]=s("small",{class:"p-error"},"Os campos marcados * sao considerados campos obrigatorios.",-1)),s("form",{onSubmit:e[3]||(e[3]=(...i)=>l(U)&&l(U)(...i))},[s("div",Ve,[e[7]||(e[7]=s("label",{for:"title"},"Titulo",-1)),a(F,{modelValue:l(S),"onUpdate:modelValue":e[0]||(e[0]=i=>P(S)?S.value=i:null),id:"title",placeholder:"Titulo",class:M({"p-invalid":l(r).title}),type:"text"},null,8,["modelValue","class"]),s("small",we,f(l(r).title),1)]),s("div",Ue,[e[8]||(e[8]=s("label",{for:"description"},"Descrição",-1)),a(F,{modelValue:l(V),"onUpdate:modelValue":e[1]||(e[1]=i=>P(V)?V.value=i:null),id:"description",placeholder:"Descrição",class:M({"p-invalid":l(r).description}),type:"text"},null,8,["modelValue","class"]),s("small",Fe,f(l(r).description),1)]),s("div",Be,[e[9]||(e[9]=s("label",{for:"duration"},"Duração",-1)),a(F,{modelValue:l(w),"onUpdate:modelValue":e[2]||(e[2]=i=>P(w)?w.value=i:null),id:"duration",placeholder:"Descrição",class:M({"p-invalid":l(r).duration}),type:"text"},null,8,["modelValue","class"]),s("small",$e,f(l(r).duration),1)]),s("div",Te,[e[10]||(e[10]=s("label",{for:"image"},"Imagem",-1)),a(L,{mode:"basic",name:"image[]",accept:"image/*",auto:"",maxFileSize:1e6,customUpload:"",onUploader:K}),k.value?(d(),p("div",Me,[s("img",{src:k.value,class:"w-32 h-32 object-cover rounded border"},null,8,Pe),s("p",qe,f((I=t.imageFile)==null?void 0:I.name),1)])):T("",!0)]),s("div",Ne,[e[12]||(e[12]=s("label",{for:"video"},"Video",-1)),a(L,{mode:"basic",name:"video[]",accept:"video/*",auto:"",maxFileSize:3e7,customUpload:"",onUploader:X}),D.value?(d(),p("div",Re,[s("video",je,[s("source",{src:D.value,type:"video/mp4"},null,8,ze),e[11]||(e[11]=W(" Seu navegador não suporta vídeo. "))]),s("p",Ee,f((O=t.videoFile)==null?void 0:O.name),1)])):T("",!0)]),a(n,{label:"Submeter",class:"mr-2 mb-2",onClick:l(U),disabled:c.value},null,8,["onClick","disabled"]),c.value?(d(),ce(m,{key:0,style:{width:"35px",height:"35px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:".5s","aria-label":"Custom ProgressSpinner"})):T("",!0)],32)])])])),a(se,{header:"Confirmação",visible:_.value,"onUpdate:visible":e[4]||(e[4]=i=>_.value=i),style:{width:"350px"},modal:!0},{footer:$(()=>[a(n,{label:"Não",icon:"pi pi-times",onClick:z,class:"p-button-text"}),a(n,{label:"Sim",icon:"pi pi-check",onClick:Z,class:"p-button-text",autofocus:""})]),default:$(()=>[e[15]||(e[15]=s("div",{class:"flex align-items-center justify-content-center"},[s("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}}),s("span",null,"Tem certeza que deseja proceder?")],-1))]),_:1},8,["visible"])],64)}}};export{rs as default};
